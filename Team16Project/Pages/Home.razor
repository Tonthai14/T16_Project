@page "/home"
@using DataLibrary
@using DataLibrary.Models
@using Team16Project.Models
@using Microsoft.Extensions.Configuration
@inject IDataAccess _data
@inject IConfiguration _config

<h3>Home Page</h3>
<div class="col-12 row">
    <h6>Number of customers in the park: @currentCustomers.ElementAt(0)</h6>
</div>
<div class="col-12 row">
    <h6>Max Capacity At: @maxCapacity.ElementAt(0)</h6>
</div>

@code {
    List<int> currentCustomers;
    List<int> maxCapacity;
    protected override async Task OnInitializedAsync()
    {
        string query = "SELECT COUNT(EnteredPark) - COUNT(LeftPark) AS CurrentCustomers FROM CUSTOMER";
        currentCustomers = await _data.LoadData<int, dynamic>(query, new { }, _config.GetConnectionString("default"));
        string max = "SELECT MaxCapacity FROM PARK WHERE ParkId = 1;";
        maxCapacity = await _data.LoadData<int, dynamic>(max, new { }, _config.GetConnectionString("default"));
    }
}
